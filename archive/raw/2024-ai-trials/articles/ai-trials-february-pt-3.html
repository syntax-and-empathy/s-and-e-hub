<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ai-trials-february-pt-3 – Syntax &amp; Empathy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-c11994fcf07a16f1c4dfa798fec8ff96.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Syntax &amp; Empathy</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../articles/"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../resources/"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#an-expert-in-chinas-lunar-calendar" id="toc-an-expert-in-chinas-lunar-calendar" class="nav-link active" data-scroll-target="#an-expert-in-chinas-lunar-calendar">An Expert in China’s Lunar Calendar</a>
  <ul class="collapse">
  <li><a href="#image-description-challenges" id="toc-image-description-challenges" class="nav-link" data-scroll-target="#image-description-challenges">Image Description Challenges</a></li>
  </ul></li>
  <li><a href="#concessions-piecing-together-a-post" id="toc-concessions-piecing-together-a-post" class="nav-link" data-scroll-target="#concessions-piecing-together-a-post"><strong>Concessions: Piecing Together a Post</strong></a>
  <ul class="collapse">
  <li><a href="#accepting-defeat-a-bad-round" id="toc-accepting-defeat-a-bad-round" class="nav-link" data-scroll-target="#accepting-defeat-a-bad-round">Accepting Defeat, A Bad Round</a></li>
  </ul></li>
  <li><a href="#key-insights" id="toc-key-insights" class="nav-link" data-scroll-target="#key-insights">Key Insights</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<p><u></u>Artwork created with Midjourney v5.2### Preface</p>
<p>This post is part of a year-long <u>initiative where I employ AI to create content</u> about holiday traditions worldwide. The objective is to observe how various AI tools perform and improve in content creation with minimal human intervention over time. This article is 3 of 8 posts for the month of <u>February</u>.</p>
<p><em>Prompts and interactions with different AI models will be documented as they occur, providing insights into the methodologies, challenges, and adjustments made throughout the project.</em></p>
<p>Creating articles for the first day of the Spring Festival using the <u>specialized roles covered in prior articles</u> presented a study in contrasts. Chat-GPT-4 produced a decent article without any additional prompting, while Claude v2.1 presented challenges at every turn. Although its specialized role certainly contributed to the difficulties, it seemed to exacerbate what have typically been minor issues, turning them into significant obstacles.</p>
<section id="an-expert-in-chinas-lunar-calendar" class="level2">
<h2 class="anchored" data-anchor-id="an-expert-in-chinas-lunar-calendar">An Expert in China’s Lunar Calendar</h2>
<pre><code>Assume the role of a Historian specializing in the History of China and the Lunar Calendar with the following skills and traits:

- Expertise in the historical development and cultural significance of the Lunar Calendar in China
- In-depth knowledge of major dynasties, cultural evolutions, and historical events in China
- Proficiency in historical research methods and sources relevant to Chinese history
- Ability to analyze historical data and trends related to the Lunar Calendar and its impact on Chinese society
- Skilled in narrative storytelling and making complex historical concepts accessible to a general audience
- Experience in writing engaging and informative articles, essays, or books on historical topics
- Proficiency in using digital archives, libraries, and databases for historical research
- Ability to apply critical thinking to analyze and interpret historical evidence
- Creativity in presenting historical information in new and interesting ways
- Knowledge of historiography and different historical interpretations related to China
- Adaptability to incorporate new research findings and perspectives into writings
- Attention to detail in historical accuracy and citation of sources
- Skills in conducting thorough literature reviews and synthesizing research findings
- Commitment to continuous learning and staying updated on new research in Chinese history and historiography
- Clear and concise communication skills for writing and presenting historical information

I need a series of articles for my blog about the Spring Festival in China. There will be an article to kick off the series, a post about the specifics of each day, and then a final article to wrap things up on the final day of celebrations. Respond with "Ready" to begin.</code></pre>
<p>Ready</p>
<pre><code>[template]

This is the template specific to the first day of an event that spans multiple days. It should cover the festival as a whole as well as any specific celebrations or practices on the first day. Tell me about Spring Festival in China using this template and instructions.</code></pre>
<p>Here is an article on the first day of Spring Festival celebrations in China:</p>
<p><strong>A Renewal of Spring</strong></p>
<p><strong>The First Day of China’s Lunar New Year Festivities</strong></p>
<p>As the sun sets on the eve of the Lunar New Year, families across China finish preparations for the most important annual holiday. Doors are festooned with red banners and lanterns, tables overflow with auspicious foods, and celebrations last long into the night. At midnight, fireworks fill the skies while smiles and laughter fill households. The year’s opportunities have begun.</p>
<p>In a multimedia portrait capturing the excitement of the new year’s arrival, crowds fill city streets on Chinese New Year’s Eve with dragon and lion dances. Wide-angled shots depict dazzling firework displays as well as intimate scenes of multi-generational families gathered for their reunion dinner. With bold reds predominating, strings of lanterns, shiny gold ingots, and flowering peach trees symbolize renewed vitality. As old gives way to new, this is a time for hopes, dreams, and new beginnings.</p>
<p><strong>A History of Renewal and Rebirth</strong></p>
<p>Spring Festival marks the beginning of a new lunar cycle on the Chinese calendar, a history interwoven with mythology and agricultural rhythms stretching back over 4,000 years. Ancient stories tell of a monster named Nian who emerged to prey on villagers at year’s end. To frighten Nian away, people decorated their homes in red and lit bamboo stalk fires, customs still observed today.</p>
<p>Engravings on oracle bones used in Shang dynasty rituals reference an annual rain ceremony believed to be an early observance of Lunar New Year. Han dynasty murals depict now familiar new year traditions—colored lanterns, banquet feasting, children receiving red envelopes of luck money. By the Qing dynasty, ancestral veneration and family reunions solidified as core elements of the 15-day celebration.</p>
<p>As bright as the hope carried into each Lunar New Year is, Spring Festival also serves as a period of reflections and renewals—debts are paid, houses cleaned, hair cut, and new clothes donned.</p>
<p><strong>Unity, Abundance and Sweet Beginnings</strong></p>
<p>The first day’s sunrise marks a palpable shift as festivities officially commence with visits to temples and family reunions over sumptuous feasts. Platters bear auspicious meanings—dumplings shaped like gold ingots, noodles denoting long life, pig’s head signifying riches. Flashing a congress of smartphones, relatives capture the bounty and the bonds framing the new year.</p>
<p>In streams of red ribbons, dragon dances weave through neighborhoods spreading blessings and good fortune. Strings of firecrackers snap and sizzle chasing ill-omens. Families young and old exchange hongbao, the red envelopes stuffed with money that parents and grandparents eagerly press into little hands. Tonight rockets will burst in dazzling ascension before floating down as smoldering wishes.</p>
<p>As the first day of Spring Festival closes, families reflect on lunar cycles, seasonal change and all that their shared history represents. In 15 days, colored lanterns will be put away but the light within rekindled connections will burn on in hearts through the coming year. The time for renewal has begun.</p>
<p><strong>Conclusion</strong></p>
<p>Spring Festival remains the most significant and festive holiday in China, a profound renewal embracing family bonds, hopes reborn and the certain continuity hidden within each ending. As long as humanity needs pauses between seasons and reassurance as years transition, the promises of Spring Festival will endure.</p>
<section id="image-description-challenges" class="level3">
<h3 class="anchored" data-anchor-id="image-description-challenges">Image Description Challenges</h3>
<p>I noticed the photo descriptions were missing, a situation not uncommon with Claude. Typically, it is a straightforward response that indicates it does not currently create images. To address this, I incorporated template instructions, which had effectively resolved the issue in the past.</p>
<p>It was only after the second request, when Claude includes a portion of the instructions, that I realized it had actually provided the instructions for the photographs within the descriptions themselves. This resulted in its output being too erratic for image generation and unnecessarily consumed the allotted word count of the article, rendering the content ineffective.</p>
<pre><code>It appears you didn't stick to the template. Additionally, you did not provide the instructions for the images.</code></pre>
<p>You’re right, my apologies. I got a bit carried away with the narrative and did not fully follow the provided template. Here is another attempt at the first day of Spring Festival content using the exact template structure and image instructions you provided:</p>
<p><strong>A Renewal of Vitality: The Eve of Possibilities</strong></p>
<p>As the sun dips below the horizon on New Year’s Eve, what dreams fuel the spectacle of color flooding China’s streets? For over 4,000 years, this has been a night of hopes renewed.</p>
<p>In a series of wide-angled photographs depleted of extraneous details, crowds pack public spaces on New Year’s Eve with dragon dances, fireworks, and families laden with gifts and foods that define a cultural heritage. Intimate portraits etched in black and white capture the spectrum of emotions as old gives way to new - nostalgia and optimism, sadness and joy, uncertainty and anticipation.</p>
<p><strong>A History of Cycles and Reunions</strong></p>
<p>Marking the start of a new lunar cycle, Spring Festival origins intertwine myth and agricultural rhythms tied to winter solstice and the story of Nian, the beast that emerged to prey on villagers at year’s end. Village preparations included red decor, fires, and loud noises to frighten Nian away - customs now intrinsically tied to the festival.</p>
<p>Murals from Han dynasty tombs depict early Spring Festival traditions - colored lanterns, banquet feasting, children receiving red envelopes filled with coins. By the Qing dynasty, thick record books and scrolls marked the period’s prominent focus on ancestry and familial unity throughout the 15 days.</p>
<p>Spring Festival underscores reflections and renewals - debts repaid, houses cleaned, new garments donned. What closure enables the unfettered hopes born each New Year’s dawn?</p>
<p><strong>An Explosion of Jubilance</strong></p>
<p>In a progression of photographs transitioning from black and white to color, the first sunrise initiates auspicious temple visits and long-awaited family reunions filled with sumptuous feasts. Platters burst with luck - dumplings evoking ingots, longevity noodles, fish symbolizing surplus. Strings of firecrackers snap frenzied rhythms while crimson ribbons spiral and soar atop glittering dragon dances weaving their flamboyant spells through awestruck crowds.</p>
<p>As the first day draws to a close, families reflect on the inception of this seminal 15-day celebration - on cycles of dark and light and on the promises of renewal no matter one’s creed or circumstance on this shared planet. The time for revival has come.</p>
<p><strong>Additional Image Instructions</strong></p>
<p>Descriptions should be 100-150 words long with visually rich detail but without sounds or motion.</p>
<p>When depicting individuals, drawings or illustrations should be used rather than photographs.</p>
<p>For historical events or practices, describe the medium or style as if painted in a mural or shown in black and white film.</p>
<p>Use a mix of shot angles and perspectives in descriptions - closeups, wide shots, overhead, etc.</p>
<p>Let me know if you would like me to continue with the full article template for the first day of celebrations.</p>
</section>
</section>
<section id="concessions-piecing-together-a-post" class="level2">
<h2 class="anchored" data-anchor-id="concessions-piecing-together-a-post"><strong>Concessions: Piecing Together a Post</strong></h2>
<p>After several attempts to navigate the unfolding chaos, I decided to omit the image descriptions altogether. The article that emerged was somewhat underwhelming, but by merging stronger elements from previous drafts and utilizing snippets for image creation, I succeeded in assembling a coherent post. Advancing to the exploration of tones will clearly have to wait for a point in time after I address these issues.</p>
<pre><code>Ok, just write the article again, ignore providing photo descriptions.</code></pre>
<p>Got it, here is the first day article without any photo descriptions:</p>
<p><strong>A Renewal of Vitality: Launching China’s Spring Festival</strong></p>
<p><strong>The Eve of Possibilities</strong></p>
<p>As the sun disappears below the horizon on New Year’s Eve, what dreams and anticipations fuel the bursts of vibrant color soon to flood China’s streets? For over 4,000 years, this transitional night has been one of renewed hopes and expectations.</p>
<p><strong>A History of Cycles and Reunions</strong></p>
<p>The early origins of Spring Festival combine mythological and agricultural elements – the triumph over Nian, a beast that emerged to prey on villagers at year’s end, and the advent of a new lunar cycle coinciding with winter solstice. To frightened Nian away, the story goes that villagers decorated in red, set off firecrackers, and gathered to feast – ubiquitous customs today.</p>
<p>For many, the festival underscores the need for reflection on the past year and marking new beginnings – repaying debts, extensive house cleaning, purchasing fresh garments. What spiritual and mental space must be cleared for hopes to fully flourish each dawn of the new year?</p>
<p><strong>Traditions of Unity, Abundance and Sweet Beginnings</strong></p>
<p>As the first sunrise illuminates the start of the Spring Festival early on New Year’s Day, a progression of five photographs visually captures the essence of the day’s meaning – temple visits, beautiful feasts, sweet glutinous rice balls in warm broth. Strings of firecrackers pepper the air as crimson ribbons spiral wildly atop glittering dragons parading through festive crowds. Foods filling tabletops burst with symbolic luck and abundance – perfectly folded dumplings shaped like ingots herald wealth, lengthy noodles promise longevity, fish represent surplus for the coming year.</p>
<p><strong>Impact and Celebrations Today</strong></p>
<p>While extravagant fireworksardi Gras continue to fill China’s modern urban cityscapes as part of Spring Festival, at its heart the holiday remains firmly rooted in family and renewal. As the first day concludes, families reflect on the broader meaning of this seminal 15-day celebration––the promises of revival and continuity even in endings.</p>
<p><strong>Conclusion</strong></p>
<p>Spring Festival endures as the most cherished holiday on the Chinese calendar, profound in embracing family bonds while reigniting individual hopes and marking the advent of a fresh beginning. As long as humanity revels in the symbolic pause between seasons and draws comfort from the reassuring cycles of old and new, Spring Festival will thrive as a celebration of spiritual and emotional renewal.</p>
<section id="accepting-defeat-a-bad-round" class="level3">
<h3 class="anchored" data-anchor-id="accepting-defeat-a-bad-round">Accepting Defeat, A Bad Round</h3>
<p>While I anticipated some challenges, the extent of the difficulties was frustrating. I have yet to address the issues encountered during the test run of specialized roles, but it’s clear that the root of the problem was the request for image descriptions. At this point, I believe that the complications arose from a combination of the specialized role, my oversight in distinguishing between “role-play” and “assuming a role,” and the inherent difficulties I’ve already experienced with Claude in obtaining image descriptions.</p>
</section>
</section>
<section id="key-insights" class="level2">
<h2 class="anchored" data-anchor-id="key-insights">Key Insights</h2>
<p><strong>Positive Observations:</strong></p>
<ul>
<li>Chat-GPT-4 demonstrated the ability to produce decent articles without additional prompting, showcasing the value of using specialized roles.</li>
</ul>
<p><strong>Encountered Challenges:</strong></p>
<ul>
<li>Claude v2.1 presented significant challenges, with its specialized role exacerbating minor issues into major obstacles.</li>
<li>Distinguishing between “role-play” and “assuming a role” proved to be a critical factor in the success of the task, highlighting the need for precise language when setting expectations for AI performance.</li>
</ul>
<p><u></u>Artwork created with Midjourney v5.2<u></u></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/syntaxandempathy\.github\.io\/s-and-e-hub");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© {date:YYYY} Syntax &amp; Empathy</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>